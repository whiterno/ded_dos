;*************************************************
; SAV_STR.ASM (c) Ded
;*************************************************
my_program segment                      ; Сегмент исполняемого кода программы
assume cs: my_program, ds: my_program   ; CS, DS указывают на my_program
org 100h                                ; Начало исполняемого кода с CS:100h
;-------------------------------------------------
	new_line equ 13,10
	beep     equ 7
	BUF_SIZE equ 20
;=================================================
start:	mov ah, 09h               ; ДОС функция #09 - вывести на экран строку
	lea dx, start_mess        ; адрес строки для вывода
	int 21h                   ; просим ДОС вывести строку
	mov ah, 0ah               ; в AH - номер функции ввода строки ДОС
	lea dx, string            ; адрес буфера
	int 21h                   ; передаем управление ДОС
	mov bx, dx                ; перекидываем
	cmp byte ptr [bx+1], 0    ; сравниваем число введенных байт с 0
	je error                  ; строка пуста - переходим на error
	push dx                   ; сохраняем адрес буфера в стеке
	mov ah, 09h               ; Функция 09 ДОС - вывод строки
	lea dx, message           ; адрес строки для вывода
	                          ; сообщения "You have typed:"
	int 21h                   ; передаем управление ДОС
	pop dx                    ; восстанавливаем DS - теперь там опять
	                          ; адрес буфера
	inc dx                    ; теперь DX указывает на 1-й байт
				  ; - пропускаем размер буфера
	inc dx                    ; теперь DX указывает на 2-й байт
				  ; - пропускаем число введенных символов
				  ; Теперь DX указывает на саму строку
	int 21h                   ; Выводим строку (буфер введенных символов)
	jmp exit                  ; Переходим на конец (Хм...)


error:	mov ah, 09h               ; Ошибка: пустая строка. Выводим соответ-
				  ; ствующее сообщение и пищим 1 сек.
	lea dx, mess_noth         ; адрес строки для вывода
	int 21h                   ; просим ДОС вывести строку

exit:	mov ax, 4c00h             ; Выходим из программы с кодом выхода 0
	int 21h                   ; Выходим...

	string  db BUF_SIZE,0, BUF_SIZE+2 dup ('$')   ; Буфер для ввода.
						      ; 0-й байт - размер
						      ; 1-й байт - заполняет
						      ; ДОС (число действи-
						      ; тельно введенных сим-
						      ; волов).
	message db 10, 'You have typed:',new_line,'$' ; Сообщения для вывода
						      ; на экран ('$' - признак
	start_mess db 'Copyright (c) Ded, 1990. '     ; конца (Хм...) строки
		   db 'Welcome to DOS input!', new_line
		   db 'Type some letters and press ENTER.'
		   db new_line, '$'
	mess_noth  db beep, 'You typed nothing!', '$'
;==================================================
my_program ends                   ; Конец (Хм...) сегмента
;**************************************************
end start                         ; Исполняемый код начинается с метки start

